# 自动化测试管理平台（ATS）前端需求文档

## 文档信息

| 项目名称 | 自动化测试管理平台前端（Automated Test System Frontend） |
|---------|-------------------------------------------|
| 文档版本 | v1.0 |
| 编写日期 | 2025-12-14 |
| 文档状态 | 待评审 |
| 技术栈 | Vue 3 + TypeScript |

---

## 1. 项目概述

### 1.1 项目背景

作为自动化测试管理平台的前端部分，本前端系统需要提供一个现代化、易用的用户界面，实现测试用例管理、测试计划管理、测试执行、测试报告等核心功能。前端采用前后端分离架构，通过RESTful API与后端进行数据交互，通过WebSocket实现实时数据推送。

### 1.2 项目目标

1. **用户体验优化**：提供直观、流畅的用户界面，降低学习成本
2. **功能完整性**：完整实现所有业务功能，包括用例管理、计划管理、执行管理等
3. **性能优化**：确保页面加载速度快，交互响应及时
4. **可维护性**：代码结构清晰，组件化程度高，便于后续维护和扩展
5. **响应式设计**：适配PC端和移动端，提供良好的跨设备体验

### 1.3 与后端交互

- **API通信**：使用Axios进行HTTP请求，遵循RESTful API规范
- **认证方式**：JWT Token认证，Token存储在localStorage或sessionStorage
- **实时通信**：使用WebSocket接收测试执行日志、状态更新等实时数据
- **错误处理**：统一的错误处理机制，友好的错误提示
- **数据格式**：请求和响应统一使用JSON格式

---

## 2. 技术栈要求

### 2.1 核心框架

- **Vue 3**：采用Composition API，使用`<script setup>`语法
- **TypeScript**：全面使用TypeScript，提供类型安全保障
- **Vite**：构建工具，提供快速的开发体验和优化的生产构建

### 2.2 状态管理

- **Pinia**：Vue 3官方推荐的状态管理库
  - 用户状态管理（用户信息、权限等）
  - 项目状态管理（当前项目、项目列表等）
  - UI状态管理（侧边栏折叠、主题等）

### 2.3 UI组件库

- **Ant Design Vue**：主要UI组件库
  - 使用Ant Design Vue 4.x版本
  - 自定义主题配置，符合项目设计规范
  - 按需引入组件，优化打包体积

### 2.4 路由管理

- **Vue Router**：Vue 3官方路由库
  - 支持路由懒加载
  - 路由守卫（认证检查、权限验证）
  - 路由元信息配置

### 2.5 HTTP客户端

- **Axios**：HTTP请求库
  - 统一的请求拦截器（添加Token、处理请求参数）
  - 统一的响应拦截器（错误处理、Token刷新）
  - 请求取消功能
  - 请求重试机制

### 2.6 图表库

- **ECharts**：数据可视化图表库
  - 仪表盘数据展示
  - 测试执行趋势图
  - 测试计划进度图
  - 模块测试覆盖图

### 2.7 工具库

- **FileSaver.js**：文件下载处理
- **dayjs**：日期时间处理
- **lodash-es**：工具函数库（按需引入）
- **vue-draggable-plus**：拖拽功能支持

### 2.8 实时通信

- **WebSocket**：原生WebSocket或Socket.IO
  - 测试执行日志实时推送
  - 测试状态实时更新
  - 通知消息实时接收

### 2.9 开发工具

- **ESLint**：代码规范检查
- **Prettier**：代码格式化
- **Husky**：Git hooks管理
- **Vitest**：单元测试框架
- **Vue Test Utils**：Vue组件测试工具

---

## 3. 页面结构设计

### 3.1 整体布局

```
+---------------------------------------------------+
| 顶部导航栏（Header）                               |
| - Logo                                           |
| - 项目选择器                                      |
| - 用户信息/通知/设置                              |
+---------------------------------------------------+
| 侧边栏（Sidebar）  |  主内容区（Main Content）    |
| - 导航菜单        |  - 路由视图                   |
| - 可折叠          |  - 面包屑导航                 |
|                   |  - 页面内容                   |
+---------------------------------------------------+
```

### 3.2 登录页面（Login）

**路由路径**：`/login`

**功能要求**：
- 用户名/邮箱登录
- 密码输入（支持显示/隐藏）
- 记住我功能
- 忘记密码链接
- 登录按钮加载状态
- 错误提示显示

**UI设计**：
- 居中布局，简洁美观
- 响应式设计，适配移动端
- 支持键盘Enter键提交

**代码示例**：
```vue
<template>
  <div class="login-container">
    <a-card class="login-card">
      <h1>自动化测试管理平台</h1>
      <a-form :model="loginForm" @submit="handleLogin">
        <a-form-item name="username" :rules="[{ required: true, message: '请输入用户名' }]">
          <a-input v-model:value="loginForm.username" placeholder="用户名/邮箱" />
        </a-form-item>
        <a-form-item name="password" :rules="[{ required: true, message: '请输入密码' }]">
          <a-input-password v-model:value="loginForm.password" placeholder="密码" />
        </a-form-item>
        <a-form-item>
          <a-checkbox v-model:checked="loginForm.remember">记住我</a-checkbox>
        </a-form-item>
        <a-form-item>
          <a-button type="primary" html-type="submit" :loading="loading" block>
            登录
          </a-button>
        </a-form-item>
      </a-form>
    </a-card>
  </div>
</template>
```

### 3.3 项目列表页面（Project List）

**路由路径**：`/projects`

**功能要求**：
- 项目列表展示（卡片或表格形式）
- 项目搜索功能
- 创建项目按钮
- 项目操作（编辑、删除、归档）
- 项目统计信息展示

**UI设计**：
- 支持卡片视图和列表视图切换
- 项目卡片显示：项目名称、描述、负责人、状态、用例数量等
- 响应式网格布局

### 3.4 用例管理页面（TestCase Management）- 核心页面

**路由路径**：`/projects/:projectId/test-cases`

**页面布局**：
```
+---------------------------------------------------+
| 左侧面板(用例树)          | 右侧面板(用例详情/编辑) |
|                         |                       |
| [项目A]                 | 用例名称: __________  |
|   ├─ 登录模块           | 前置条件: __________  |
|   │  ├─ 密码登录        | 步骤:                |
|   │  └─ 验证码登录      |   1. __________     |
|   └─ 支付模块           |   2. __________     |
|                         | 模块: [树形选择]     |
| 右键菜单:               | 等级: P0 ○ P1 ○ ...  |
|   • 新增模块            | 执行人: [下拉选择]   |
|   • 新增用例            | 标签: [可输入多个]   |
|   • 编辑                | 附件: [上传区域]     |
|   • 删除                |                       |
|   • 执行用例            | [保存] [取消]        |
|   • 导入                +-----------------------+
|   • 导出                | 执行历史/结果展示区   |
+---------------------------------------------------+
```

**功能要求**：

**左侧用例树**：
- 树形结构展示项目和模块层级
- 支持节点展开/折叠
- 支持拖拽排序（模块和用例）
- 右键菜单操作
- 节点图标区分（模块/用例）
- 用例节点显示优先级标识
- 搜索过滤功能
- 懒加载（大数据量时）

**右侧详情/编辑区**：
- 用例基本信息编辑表单
- 测试步骤编辑（支持富文本）
- 标签管理（输入和选择）
- 附件上传（多文件，显示进度）
- 模块选择器（树形结构）
- 执行历史展示
- 执行结果展示

**代码示例**：
```vue
<template>
  <div class="test-case-management">
    <a-layout>
      <!-- 左侧用例树 -->
      <a-layout-sider width="300" class="tree-sider">
        <TestCaseTree
          :project-id="projectId"
          @select="handleCaseSelect"
          @right-click="handleRightClick"
        />
      </a-layout-sider>
      
      <!-- 右侧详情区 -->
      <a-layout-content class="detail-content">
        <TestCaseDetail
          v-if="selectedCase"
          :case-id="selectedCase.id"
          @save="handleSave"
          @cancel="handleCancel"
        />
        <div v-else class="empty-state">
          <a-empty description="请选择一个测试用例" />
        </div>
      </a-layout-content>
    </a-layout>
  </div>
</template>
```

### 3.5 测试计划页面（Test Plan）

**路由路径**：`/projects/:projectId/test-plans`

**功能要求**：
- 测试计划列表（表格形式）
- 创建测试计划
- 计划详情查看和编辑
- 计划用例管理（添加、移除、分配）
- 计划进度展示
- 计划状态管理（启动、暂停、完成）

**UI设计**：
- 计划列表显示：名称、状态、进度、时间范围等
- 进度条可视化
- 支持筛选和排序

### 3.6 执行历史页面（Execution History）

**路由路径**：`/projects/:projectId/executions`

**功能要求**：
- 执行记录列表
- 执行详情查看
- 执行日志查看（实时日志展示）
- 执行结果筛选
- 执行统计信息
- 附件查看和下载

**UI设计**：
- 表格展示执行记录
- 支持按时间、结果、执行人等筛选
- 日志面板支持实时滚动
- 支持日志级别过滤（INFO、WARN、ERROR）

### 3.7 仪表盘页面（Dashboard）

**路由路径**：`/dashboard` 或 `/projects/:projectId/dashboard`

**功能要求**：
- 概览指标卡片（用例总数、通过率、自动化覆盖率等）
- 测试执行趋势图（折线图）
- 测试计划进度（柱状图/饼图）
- 模块测试覆盖（柱状图）
- 最近活动列表
- 时间范围选择器
- 项目筛选器

**UI设计**：
- 响应式网格布局
- 图表支持交互（缩放、筛选）
- 支持数据导出

### 3.8 环境管理页面（Environment Management）

**路由路径**：`/environments`

**功能要求**：
- 环境列表展示
- 创建/编辑环境
- 环境配置（API地址、数据库配置、环境变量等）
- 环境启用/禁用
- 环境测试连接

**UI设计**：
- 表格或卡片展示
- 表单编辑环境信息
- JSON编辑器用于配置编辑

### 3.9 个人中心页面（Profile）

**路由路径**：`/profile`

**功能要求**：
- 个人信息展示和编辑
- 密码修改
- 通知设置
- 偏好设置（主题、语言等）
- 操作日志查看

**UI设计**：
- 标签页切换不同设置项
- 表单验证
- 头像上传

---

## 4. 组件开发要求

### 4.1 用例树组件（TestCaseTree.vue）

**组件路径**：`src/components/TestCaseTree/TestCaseTree.vue`

**功能要求**：
- 树形结构展示
- 支持懒加载
- 支持拖拽排序
- 右键菜单
- 节点选择
- 搜索过滤
- 节点图标和标识

**Props**：
```typescript
interface Props {
  projectId: number | string
  selectedKeys?: string[]
  expandedKeys?: string[]
}
```

**Events**：
```typescript
interface Emits {
  (e: 'select', node: TreeNode): void
  (e: 'right-click', node: TreeNode, event: MouseEvent): void
  (e: 'drop', info: DropInfo): void
  (e: 'refresh'): void
}
```

**代码示例**：
```vue
<template>
  <div class="test-case-tree">
    <!-- 搜索框 -->
    <a-input-search
      v-model:value="searchValue"
      placeholder="搜索用例或模块"
      @search="handleSearch"
      class="tree-search"
    />
    
    <!-- 树形组件 -->
    <a-tree
      :tree-data="treeData"
      :load-data="onLoadData"
      :selected-keys="selectedKeys"
      :expanded-keys="expandedKeys"
      :draggable="true"
      @select="onSelect"
      @rightClick="onRightClick"
      @drop="onDrop"
    >
      <template #title="{ dataRef }">
        <div class="tree-node">
          <component :is="getNodeIcon(dataRef.type)" />
          <span>{{ dataRef.title }}</span>
          <a-tag v-if="dataRef.type === 'case'" :color="getPriorityColor(dataRef.level)">
            {{ dataRef.level }}
          </a-tag>
        </div>
      </template>
    </a-tree>
    
    <!-- 右键菜单 -->
    <div
      v-if="showContextMenu"
      :style="contextMenuStyle"
      class="context-menu"
    >
      <a-menu @c