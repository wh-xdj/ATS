# 自动化测试管理平台（ATS）需求文档

## 文档信息

| 项目名称 | 自动化测试管理平台（Automated Test System） |
|---------|-------------------------------------------|
| 文档版本 | v1.2 |
| 编写日期 | 2025-12-11 |
| 修订日期 | 2025-12-14 |
| 文档状态 | 待评审 |

---

## 1. 项目概述

### 1.1 项目背景

随着软件开发的快速迭代，传统的手工测试已无法满足快速交付的需求。自动化测试管理平台旨在提供一个集中化的测试管理解决方案，帮助团队高效管理测试用例、执行测试计划、跟踪测试结果，并生成测试报告，从而提升软件质量和测试效率。

### 1.2 项目目标

1. **提升测试效率**：通过自动化测试执行，减少人工测试时间，提高测试覆盖率
2. **统一测试管理**：集中管理测试用例、测试计划、测试执行和测试报告
3. **实时质量监控**：提供实时测试仪表盘，快速了解项目测试状态和质量指标
4. **测试报告生成**：自动生成测试报告，支持多维度数据分析和导出

### 1.3 目标用户

- **测试工程师**：编写和管理测试用例，执行测试计划
- **测试经理**：制定测试计划，监控测试进度和质量
- **开发工程师**：查看测试结果
- **项目经理**：查看测试报告，了解项目质量状况
- **质量保证（QA）团队**：负责整体测试质量把控

### 1.4 项目范围

**包含功能：**
- 测试用例管理
- 测试计划管理
- 测试执行管理
- 测试报告生成
- 测试仪表盘
- 用户管理
- 测试环境管理
- 通知与提醒

---

## 2. 功能需求

### 2.1 用户认证与管理

#### 2.1.1 用户登录/登出
- **登录方式**：用户名/密码登录、邮箱登录、SSO单点登录（可选）
- **密码策略**：支持密码强度验证、密码找回、密码修改
- **会话管理**：支持会话超时、多设备登录控制
- **登出功能**：安全登出，清除会话信息

#### 2.1.2 用户管理
- **用户信息**：用户名、邮箱、手机号、部门、状态（启用/禁用）
- **用户操作**：创建、编辑、删除、启用/禁用用户
- **用户搜索**：支持按姓名、邮箱、部门等条件搜索

### 2.2 项目管理

#### 2.2.1 项目创建与管理
- **项目信息**：项目名称、项目描述、项目负责人、创建时间、状态
- **项目操作**：创建、编辑、删除、归档项目
- **项目成员**：添加/移除项目成员
- **项目设置**：项目配置、通知设置

#### 2.2.2 项目模块管理
- **模块层级**：支持多级模块结构（如：一级模块 > 二级模块 > 三级模块）
- **模块操作**：创建、编辑、删除、移动模块
- **模块统计**：显示模块下的用例数量、执行情况

### 2.3 测试用例管理

#### 2.3.1 测试用例基本信息
- **用例编号**：自动生成唯一编号（如：TC-PROJECT-001）
- **用例标题**：简洁明了的用例名称
- **所属模块**：关联项目模块
- **用例类型**：功能测试、接口测试、UI测试、性能测试、安全测试
- **优先级**：高、中、低
- **前置条件**：执行用例前需要满足的条件
- **测试步骤**：详细的测试步骤（支持步骤编号、操作、预期结果）
- **预期结果**：每个步骤的预期结果
- **标签**：自定义标签，便于分类和搜索
- **关联需求**：关联需求编号或需求链接

#### 2.3.2 测试用例操作
- **创建用例**：支持单个创建和批量导入（Excel、CSV）
- **编辑用例**：修改用例信息
- **删除用例**：支持单个删除和批量删除
- **复制用例**：快速复制用例，支持跨项目复制
- **用例版本**：支持用例版本历史记录和版本对比
- **用例评审**：支持用例评审流程，记录评审意见

#### 2.3.3 测试用例查询与筛选
- **搜索功能**：支持按用例编号、标题、内容全文搜索
- **筛选条件**：
  - 所属模块
  - 用例类型
  - 优先级
  - 创建人
  - 创建时间
  - 最近执行时间
  - 执行状态
  - 标签
- **排序功能**：支持多字段排序（编号、创建时间、优先级等）
- **分页显示**：支持自定义每页显示数量

#### 2.3.4 测试用例执行状态
- **状态类型**：
  - 未执行：用例尚未执行
  - 通过：用例执行通过
  - 失败：用例执行失败
  - 阻塞：用例因环境或依赖问题无法执行
  - 跳过：用例被跳过执行
- **执行历史**：记录每次执行的详细信息（执行人、执行时间、执行结果、备注）

### 2.4 测试计划管理

#### 2.4.1 测试计划基本信息
- **计划编号**：自动生成唯一编号（如：TP-20251211-001）
- **计划名称**：测试计划标题
- **计划描述**：计划说明和目标
- **关联项目**：所属项目
- **计划负责人**：测试计划负责人
- **计划时间**：开始时间、结束时间
- **计划状态**：未开始、执行中、已完成、已暂停、已逾期
- **计划类型**：功能测试计划、回归测试计划、专项测试计划

#### 2.4.2 测试计划用例管理
- **用例选择**：从项目用例库中选择用例加入计划
- **用例分组**：支持按模块、优先级、类型等分组
- **用例分配**：将用例分配给指定的测试人员
- **用例排序**：自定义用例执行顺序

#### 2.4.3 测试计划操作
- **创建计划**：创建新的测试计划
- **编辑计划**：修改计划信息、添加/移除用例
- **启动计划**：开始执行测试计划
- **暂停计划**：暂停正在执行的计划
- **恢复计划**：恢复已暂停的计划
- **完成计划**：标记计划为已完成
- **复制计划**：基于现有计划创建新计划
- **删除计划**：删除测试计划（需确认）

#### 2.4.4 测试计划进度跟踪
- **进度统计**：
  - 总用例数
  - 已执行用例数
  - 通过用例数
  - 失败用例数
  - 阻塞用例数
  - 跳过用例数
  - 执行进度百分比
  - 通过率
- **进度可视化**：进度条、饼图、柱状图展示
- **实时更新**：执行状态实时更新到计划进度

### 2.5 测试执行管理

#### 2.5.1 测试执行方式
- **手动执行**：测试人员手动执行用例并记录结果
- **自动化执行**：通过调用自动化测试脚本执行
- **批量执行**：批量执行多个用例
- **定时执行**：支持定时任务自动执行测试计划

#### 2.5.2 测试执行记录
- **执行信息**：
  - 执行ID
  - 关联测试计划
  - 关联测试用例
  - 执行人
  - 执行时间
  - 执行环境
  - 执行结果（通过/失败/阻塞/跳过）
  - 执行耗时
  - 执行备注
  - 附件（截图、日志文件等）
- **失败详情**：记录失败原因、错误信息、错误截图
- **执行日志**：记录详细的执行日志

#### 2.5.3 测试执行操作
- **开始执行**：开始执行测试用例或测试计划
- **记录结果**：记录用例执行结果
- **添加备注**：添加执行备注和说明
- **上传附件**：上传执行截图、日志文件等
- **重新执行**：重新执行失败的用例

### 2.6 测试报告管理

#### 2.6.1 测试报告类型
- **执行报告**：单次测试执行报告
- **计划报告**：测试计划执行报告
- **项目报告**：项目整体测试报告
- **自定义报告**：自定义时间范围和条件的报告

#### 2.6.2 测试报告内容
- **报告概览**：
  - 报告生成时间
  - 报告时间范围
  - 测试范围（项目、模块、用例数量）
- **执行统计**：
  - 总用例数
  - 执行用例数
  - 通过用例数及通过率
  - 失败用例数及失败率
  - 阻塞用例数
  - 跳过用例数
- **质量指标**：
  - 测试覆盖率
  - 自动化覆盖率
- **趋势分析**：
  - 通过率趋势图
  - 执行用例数趋势图
- **用例详情**：列出所有用例的执行情况

#### 2.6.3 测试报告操作
- **生成报告**：自动生成或手动生成报告
- **查看报告**：在线查看报告详情
- **导出报告**：支持导出PDF、Excel、HTML格式
- **报告分享**：生成报告链接，支持分享给其他用户
- **报告历史**：保存历史报告，支持查看和对比

### 2.7 测试仪表盘

#### 2.7.1 概览指标
- **测试用例总数**：项目或系统的测试用例总数
- **自动化覆盖率**：自动化用例占总用例的比例
- **测试通过率**：最近一次或指定时间范围内的通过率
- **测试执行趋势**：显示测试执行数量的趋势变化

#### 2.7.2 图表展示
- **测试执行趋势图**：折线图展示通过率和用例数趋势
- **测试计划进度**：展示各测试计划的执行进度
- **模块测试覆盖**：展示各模块的测试覆盖情况

#### 2.7.3 最近活动
- **最近测试执行**：显示最近的测试执行记录
- **待办任务**：显示测试相关的待办任务

#### 2.7.4 自定义仪表盘
- **指标选择**：用户可选择显示的指标
- **时间范围**：支持选择不同的时间范围（今天、本周、本月、自定义）
- **项目筛选**：支持按项目筛选数据
- **导出功能**：支持导出仪表盘数据

### 2.8 测试环境管理

#### 2.8.1 环境配置
- **环境信息**：
  - 环境名称（开发环境、测试环境、预发布环境、生产环境）
  - 环境地址（API地址、Web地址）
  - 数据库配置
  - 环境变量
  - 环境描述
- **环境操作**：创建、编辑、删除环境
- **环境状态**：启用/禁用环境

#### 2.8.2 环境使用
- **用例关联**：用例可关联执行环境
- **计划关联**：测试计划可指定执行环境
- **环境切换**：执行时选择执行环境

### 2.9 通知与提醒

#### 2.9.1 通知类型
- **测试计划提醒**：测试计划开始、截止提醒
- **用例分配通知**：用例分配给用户时通知
- **执行完成通知**：测试执行完成通知
- **报告生成通知**：测试报告生成完成通知

#### 2.9.2 通知方式
- **站内消息**：系统内消息通知
- **邮件通知**：发送邮件通知
- **企业微信/钉钉**：集成企业IM工具通知（可选）
- **通知设置**：用户可自定义通知偏好设置

---

## 3. 非功能需求

### 3.1 性能需求

- **响应时间**：
  - 页面加载时间 < 2秒
  - API接口响应时间 < 500ms
  - 查询操作响应时间 < 1秒
- **并发性能**：
  - 支持至少100个并发用户
  - 支持至少10个并发测试执行任务
- **数据处理**：
  - 支持单次导入至少1000条测试用例
  - 支持单次查询至少10000条记录
  - 支持生成包含10000条用例的测试报告

### 3.2 可用性需求

- **系统可用性**：99.5%以上（月度）
- **故障恢复时间**：< 4小时
- **数据备份**：每日自动备份，支持数据恢复
- **容灾能力**：支持数据备份和灾难恢复

### 3.3 安全性需求

- **身份认证**：支持密码加密存储、支持多因素认证（可选）
- **数据加密**：敏感数据传输加密（HTTPS）、敏感数据存储加密
- **操作审计**：记录关键操作日志，支持审计追踪
- **SQL注入防护**：防止SQL注入攻击
- **XSS防护**：防止跨站脚本攻击

### 3.4 兼容性需求

- **浏览器兼容**：
  - Chrome（最新2个版本）
  - Firefox（最新2个版本）
  - Safari（最新2个版本）
  - Edge（最新2个版本）
- **操作系统兼容**：
  - Windows 10及以上
  - macOS 10.14及以上
  - Linux（主流发行版）
- **移动端支持**：响应式设计，支持移动端访问（可选）

### 3.5 可扩展性需求

- **水平扩展**：支持通过增加服务器节点扩展性能
- **插件机制**：支持插件扩展功能（可选）
- **API扩展**：提供完整的RESTful API，支持第三方集成
- **数据扩展**：支持自定义字段扩展（可选）

### 3.6 可维护性需求

- **代码规范**：遵循代码规范和最佳实践
- **文档完整**：提供完整的开发文档、API文档、用户手册
- **日志记录**：完善的日志记录，便于问题排查
- **监控告警**：系统监控和告警机制

---

## 4. 技术架构

### 4.1 系统架构

**整体架构**：前后端分离架构

- **前端**：React + TypeScript + Tailwind CSS
- **后端**：Python（FastAPI/Django）或 Java（Spring Boot）
- **数据库**：MySQL/PostgreSQL（主数据库）+ Redis（缓存）
- **消息队列**：RabbitMQ/Kafka（可选，用于异步任务）
- **文件存储**：本地存储或对象存储（OSS/S3）

### 4.2 技术栈建议

#### 前端技术栈
- **框架**：React 18+
- **语言**：TypeScript
- **构建工具**：Vite
- **路由**：React Router
- **状态管理**：Redux Toolkit / Zustand
- **UI组件库**：Ant Design / Material-UI / 自定义组件
- **图表库**：Recharts / ECharts
- **HTTP客户端**：Axios
- **表单处理**：React Hook Form
- **测试框架**：Jest + React Testing Library

#### 后端技术栈
**方案一：Python**
- **Web框架**：FastAPI 或 Django
- **ORM**：SQLAlchemy 或 Django ORM
- **数据库**：MySQL/PostgreSQL
- **缓存**：Redis
- **任务队列**：Celery
- **API文档**：Swagger/OpenAPI


### 4.3 数据库设计

#### 核心数据表

##### 用户表（users）
| 字段名 | 类型 | 说明 | 约束 |
|--------|------|------|------|
| id | INTEGER | 主键 | PRIMARY KEY, AUTO_INCREMENT |
| username | VARCHAR(50) | 用户名 | UNIQUE, NOT NULL |
| email | VARCHAR(100) | 邮箱 | UNIQUE, NOT NULL |
| password_hash | VARCHAR(255) | 密码哈希 | NOT NULL |
| full_name | VARCHAR(100) | 姓名 | |
| phone | VARCHAR(20) | 手机号 | |
| department | VARCHAR(100) | 部门 | |
| status | BOOLEAN | 启用状态 | DEFAULT TRUE |
| created_at | DATETIME | 创建时间 | |
| updated_at | DATETIME | 更新时间 | |

##### 项目表（projects）
| 字段名 | 类型 | 说明 | 约束 |
|--------|------|------|------|
| id | INTEGER | 主键 | PRIMARY KEY, AUTO_INCREMENT |
| name | VARCHAR(100) | 项目名称 | NOT NULL |
| description | TEXT | 项目描述 | |
| owner_id | INTEGER | 项目负责人ID | FOREIGN KEY(users.id), NOT NULL |
| status | ENUM | 项目状态 | DEFAULT 'active' |
| created_at | DATETIME | 创建时间 | |
| updated_at | DATETIME | 更新时间 | |

##### 模块表（modules）
| 字段名 | 类型 | 说明 | 约束 |
|--------|------|------|------|
| id | INTEGER | 主键 | PRIMARY KEY, AUTO_INCREMENT |
| project_id | INTEGER | 项目ID | FOREIGN KEY(projects.id), NOT NULL |
| name | VARCHAR(100) | 模块名称 | NOT NULL |
| parent_id | INTEGER | 父模块ID | FOREIGN KEY(modules.id) |
| level | INTEGER | 模块层级 | DEFAULT 1 |
| sort_order | INTEGER | 排序 | DEFAULT 0 |
| description | TEXT | 模块描述 | |
| created_at | DATETIME | 创建时间 | |
| updated_at | DATETIME | 更新时间 | |

##### 测试用例表（test_cases）
| 字段名 | 类型 | 说明 | 约束 |
|--------|------|------|------|
| id | INTEGER | 主键 | PRIMARY KEY, AUTO_INCREMENT |
| project_id | INTEGER | 项目ID | FOREIGN KEY(projects.id), NOT NULL |
| module_id | INTEGER | 模块ID | FOREIGN KEY(modules.id) |
| case_number | VARCHAR(50) | 用例编号 | UNIQUE, NOT NULL |
| title | VARCHAR(255) | 用例标题 | NOT NULL |
| type | ENUM | 用例类型 | NOT NULL |
| priority | ENUM | 优先级 | DEFAULT 'medium' |
| preconditions | TEXT | 前置条件 | |
| steps | JSON | 测试步骤 | |
| expected_result | TEXT | 预期结果 | |
| requirement_ref | VARCHAR(255) | 关联需求 | |
| status | ENUM | 执行状态 | DEFAULT 'not_executed' |
| creator_id | INTEGER | 创建人ID | FOREIGN KEY(users.id), NOT NULL |
| created_at | DATETIME | 创建时间 | |
| updated_at | DATETIME | 更新时间 | |

##### 测试用例标签表（test_case_tags）
| 字段名 | 类型 | 说明 | 约束 |
|--------|------|------|------|
| id | INTEGER | 主键 | PRIMARY KEY, AUTO_INCREMENT |
| test_case_id | INTEGER | 用例ID | FOREIGN KEY(test_cases.id), NOT NULL |
| tag | VARCHAR(50) | 标签名称 | NOT NULL |
| created_at | DATETIME | 创建时间 | |

##### 测试计划表（test_plans）
| 字段名 | 类型 | 说明 | 约束 |
|--------|------|------|------|
| id | INTEGER | 主键 | PRIMARY KEY, AUTO_INCREMENT |
| project_id | INTEGER | 项目ID | FOREIGN KEY(projects.id), NOT NULL |
| plan_number | VARCHAR(50) | 计划编号 | UNIQUE, NOT NULL |
| name | VARCHAR(255) | 计划名称 | NOT NULL |
| description | TEXT | 计划描述 | |
| owner_id | INTEGER | 计划负责人 | FOREIGN KEY(users.id), NOT NULL |
| plan_type | ENUM | 计划类型 | DEFAULT 'functional' |
| start_date | DATE | 开始时间 | |
| end_date | DATE | 结束时间 | |
| status | ENUM | 计划状态 | DEFAULT 'not_started' |
| environment_id | INTEGER | 执行环境ID | FOREIGN KEY(environments.id) |
| created_at | DATETIME | 创建时间 | |
| updated_at | DATETIME | 更新时间 | |

##### 计划用例关联表（plan_cases）
| 字段名 | 类型 | 说明 | 约束 |
|--------|------|------|------|
| id | INTEGER | 主键 | PRIMARY KEY, AUTO_INCREMENT |
| plan_id | INTEGER | 计划ID | FOREIGN KEY(test_plans.id), NOT NULL |
| case_id | INTEGER | 用例ID | FOREIGN KEY(test_cases.id), NOT NULL |
| assigned_to | INTEGER | 分配给 | FOREIGN KEY(users.id) |
| sort_order | INTEGER | 排序 | DEFAULT 0 |
| created_at | DATETIME | 创建时间 | |

##### 测试执行表（test_executions）
| 字段名 | 类型 | 说明 | 约束 |
|--------|------|------|------|
| id | INTEGER | 主键 | PRIMARY KEY, AUTO_INCREMENT |
| plan_id | INTEGER | 关联测试计划 | FOREIGN KEY(test_plans.id) |
| case_id | INTEGER | 关联测试用例 | FOREIGN KEY(test_cases.id), NOT NULL |
| executor_id | INTEGER | 执行人 | FOREIGN KEY(users.id), NOT NULL |
| environment_id | INTEGER | 执行环境 | FOREIGN KEY(environments.id) |
| result | ENUM | 执行结果 | NOT NULL |
| duration | FLOAT | 执行耗时（秒） | |
| notes | TEXT | 执行备注 | |
| error_message | TEXT | 错误信息 | |
| execution_log | TEXT | 执行日志 | |
| executed_at | DATETIME | 执行时间 | |
| created_at | DATETIME | 创建时间 | |

##### 执行附件表（execution_attachments）
| 字段名 | 类型 | 说明 | 约束 |
|--------|------|------|------|
| id | INTEGER | 主键 | PRIMARY KEY, AUTO_INCREMENT |
| execution_id | INTEGER | 执行ID | FOREIGN KEY(test_executions.id), NOT NULL |
| file_name | VARCHAR(255) | 文件名 | NOT NULL |
| file_path | VARCHAR(500) | 文件路径 | NOT NULL |
| file_size | INTEGER | 文件大小（字节） | |
| file_type | VARCHAR(50) | 文件类型 | |
| created_at | DATETIME | 创建时间 | |

##### 测试报告表（test_reports）
| 字段名 | 类型 | 说明 | 约束 |
|--------|------|------|------|
| id | INTEGER | 主键 | PRIMARY KEY, AUTO_INCREMENT |
| project_id | INTEGER | 关联项目 | FOREIGN KEY(projects.id) |
| plan_id | INTEGER | 关联测试计划 | FOREIGN KEY(test_plans.id) |
| report_type | ENUM | 报告类型 | NOT NULL |
| report_name | VARCHAR(255) | 报告名称 | NOT NULL |
| start_date | DATE | 开始日期 | |
| end_date | DATE | 结束日期 | |
| report_data | JSON | 报告数据 | |
| summary | TEXT | 报告摘要 | |
| created_by | INTEGER | 创建人 | FOREIGN KEY(users.id), NOT NULL |
| created_at | DATETIME | 创建时间 | |

##### 测试环境表（environments）
| 字段名 | 类型 | 说明 | 约束 |
|--------|------|------|------|
| id | INTEGER | 主键 | PRIMARY KEY, AUTO_INCREMENT |
| name | VARCHAR(100) | 环境名称 | NOT NULL |
| api_url | VARCHAR(500) | API地址 | |
| web_url | VARCHAR(500) | Web地址 | |
| database_config | JSON | 数据库配置 | |
| env_variables | JSON | 环境变量 | |
| description | TEXT | 环境描述 | |
| status | BOOLEAN | 启用状态 | DEFAULT TRUE |
| created_at | DATETIME | 创建时间 | |
| updated_at | DATETIME | 更新时间 | |

##### 通知表（notifications）
| 字段名 | 类型 | 说明 | 约束 |
|--------|------|------|------|
| id | INTEGER | 主键 | PRIMARY KEY, AUTO_INCREMENT |
| user_id | INTEGER | 接收用户 | FOREIGN KEY(users.id), NOT NULL |
| type | ENUM | 通知类型 | NOT NULL |
| title | VARCHAR(255) | 通知标题 | NOT NULL |
| content | TEXT | 通知内容 | |
| is_read | BOOLEAN | 是否已读 | DEFAULT FALSE |
| related_id | INTEGER | 关联ID | |
| created_at | DATETIME | 创建时间 | |

##### 项目成员表（project_members）
| 字段名 | 类型 | 说明 | 约束 |
|--------|------|------|------|
| id | INTEGER | 主键 | PRIMARY KEY, AUTO_INCREMENT |
| project_id | INTEGER | 项目ID | FOREIGN KEY(projects.id), NOT NULL |
| user_id | INTEGER | 用户ID | FOREIGN KEY(users.id), NOT NULL |
| created_at | DATETIME | 创建时间 | |

### 4.4 API设计

#### API设计原则
- RESTful API设计规范
- 统一的响应格式
- 统一的错误处理
- API版本控制
- API认证

#### 主要API模块

##### 认证相关API (`/api/v1/auth`)

**POST /api/v1/auth/login** - 用户登录
- 请求参数：
  ```json
  {
    "username": "string",  // 用户名或邮箱
    "password": "string"    // 密码
  }
  ```
- 响应：
  ```json
  {
    "access_token": "string",
    "token_type": "bearer"
  }
  ```

**GET /api/v1/auth/me** - 获取当前用户信息
- 请求头：`Authorization: Bearer {token}`
- 响应：用户信息对象

**POST /api/v1/auth/logout** - 用户登出
- 请求头：`Authorization: Bearer {token}`

##### 用户管理API (`/api/v1/users`)

**GET /api/v1/users** - 获取用户列表
- 查询参数：
  - `skip`: 跳过数量（默认0）
  - `limit`: 返回数量（默认100）
  - `search`: 搜索关键词
- 响应：用户列表数组

**GET /api/v1/users/{user_id}`** - 获取用户详情
- 路径参数：`user_id` - 用户ID
- 响应：用户信息对象

**POST /api/v1/users** - 创建用户
- 请求参数：
  ```json
  {
    "username": "string",
    "email": "string",
    "password": "string",
    "full_name": "string",
    "phone": "string",
    "department": "string"
  }
  ```
- 响应：创建的用户对象

**PUT /api/v1/users/{user_id}`** - 更新用户
- 路径参数：`user_id` - 用户ID
- 请求参数：用户信息（部分字段）
- 响应：更新后的用户对象

**DELETE /api/v1/users/{user_id}`** - 删除用户
- 路径参数：`user_id` - 用户ID

##### 项目管理API (`/api/v1/projects`)

**GET /api/v1/projects** - 获取项目列表
- 查询参数：
  - `skip`: 跳过数量
  - `limit`: 返回数量
  - `search`: 搜索关键词
- 响应：项目列表数组

**GET /api/v1/projects/{project_id}`** - 获取项目详情
- 路径参数：`project_id` - 项目ID
- 响应：项目信息对象

**POST /api/v1/projects** - 创建项目
- 请求参数：
  ```json
  {
    "name": "string",
    "description": "string",
    "owner_id": 1
  }
  ```
- 响应：创建的项目对象

**PUT /api/v1/projects/{project_id}`** - 更新项目
- 路径参数：`project_id` - 项目ID
- 请求参数：项目信息（部分字段）
- 响应：更新后的项目对象

**DELETE /api/v1/projects/{project_id}`** - 删除项目
- 路径参数：`project_id` - 项目ID

**GET /api/v1/projects/{project_id}/modules** - 获取项目模块列表
- 路径参数：`project_id` - 项目ID
- 响应：模块列表数组

**POST /api/v1/projects/{project_id}/modules** - 创建模块
- 路径参数：`project_id` - 项目ID
- 请求参数：
  ```json
  {
    "name": "string",
    "description": "string",
    "parent_id": 0,
    "sort_order": 0
  }
  ```
- 响应：创建的模块对象

##### 测试用例API (`/api/v1/test-cases`)

**GET /api/v1/test-cases** - 获取测试用例列表
- 查询参数：
  - `skip`: 跳过数量
  - `limit`: 返回数量
  - `project_id`: 项目ID
  - `module_id`: 模块ID
  - `search`: 搜索关键词
- 响应：
  ```json
  {
    "total": 100,
    "items": [...]
  }
  ```

**GET /api/v1/test-cases/{case_id}`** - 获取测试用例详情
- 路径参数：`case_id` - 用例ID
- 响应：用例信息对象

**POST /api/v1/test-cases** - 创建测试用例
- 请求参数：
  ```json
  {
    "project_id": 1,
    "module_id": 1,
    "title": "string",
    "type": "functional|interface|ui|performance|security",
    "priority": "high|medium|low",
    "preconditions": "string",
    "steps": [{"step": 1, "action": "string", "expected": "string"}],
    "expected_result": "string",
    "requirement_ref": "string",
    "tags": ["tag1", "tag2"]
  }
  ```
- 响应：创建的用例对象

**PUT /api/v1/test-cases/{case_id}`** - 更新测试用例
- 路径参数：`case_id` - 用例ID
- 请求参数：用例信息（部分字段）
- 响应：更新后的用例对象

**DELETE /api/v1/test-cases/{case_id}`** - 删除测试用例
- 路径参数：`case_id` - 用例ID

**POST /api/v1/test-cases/batch-delete** - 批量删除测试用例
- 请求参数：
  ```json
  {
    "case_ids": [1, 2, 3]
  }
  ```
- 响应：
  ```json
  {
    "message": "Successfully deleted 3 test cases",
    "deleted_count": 3
  }
  ```

**GET /api/v1/test-cases/export** - 导出测试用例
- 查询参数：
  - `project_id`: 项目ID（可选）
  - `module_id`: 模块ID（可选）
  - `format`: 导出格式（json|csv，默认csv）
- 响应：CSV文件或JSON数组

**POST /api/v1/test-cases/import** - 导入测试用例
- 请求：multipart/form-data
  - `file`: 文件（CSV或JSON格式）
  - `project_id`: 项目ID（必填）
  - `module_id`: 模块ID（可选）
- 响应：
  ```json
  {
    "message": "Successfully imported 10 test cases",
    "imported_count": 10
  }
  ```

##### 测试计划API (`/api/v1/test-plans`)

**GET /api/v1/test-plans** - 获取测试计划列表
- 查询参数：
  - `skip`: 跳过数量
  - `limit`: 返回数量
  - `project_id`: 项目ID
- 响应：计划列表数组

**GET /api/v1/test-plans/{plan_id}`** - 获取测试计划详情
- 路径参数：`plan_id` - 计划ID
- 响应：计划信息对象（包含进度信息）

**POST /api/v1/test-plans** - 创建测试计划
- 请求参数：
  ```json
  {
    "project_id": 1,
    "name": "string",
    "description": "string",
    "owner_id": 1,
    "plan_type": "functional|regression|special",
    "start_date": "2025-12-11",
    "end_date": "2025-12-20",
    "environment_id": 1
  }
  ```
- 响应：创建的计划对象

**PUT /api/v1/test-plans/{plan_id}`** - 更新测试计划
- 路径参数：`plan_id` - 计划ID
- 请求参数：计划信息（部分字段）
- 响应：更新后的计划对象

**DELETE /api/v1/test-plans/{plan_id}`** - 删除测试计划
- 路径参数：`plan_id` - 计划ID

**GET /api/v1/test-plans/{plan_id}/cases** - 获取计划用例列表
- 路径参数：`plan_id` - 计划ID
- 响应：计划用例列表数组

**POST /api/v1/test-plans/{plan_id}/cases** - 添加用例到计划
- 路径参数：`plan_id` - 计划ID
- 请求参数：
  ```json
  {
    "case_id": 1,
    "assigned_to": 1,
    "sort_order": 0
  }
  ```
- 响应：创建的计划用例对象

**DELETE /api/v1/test-plans/{plan_id}/cases/{case_id}`** - 从计划中移除用例
- 路径参数：`plan_id` - 计划ID, `case_id` - 用例ID

##### 测试执行API (`/api/v1/test-executions`)

**GET /api/v1/test-executions** - 获取测试执行列表
- 查询参数：
  - `skip`: 跳过数量
  - `limit`: 返回数量
  - `plan_id`: 计划ID
  - `case_id`: 用例ID
- 响应：执行记录列表数组

**GET /api/v1/test-executions/{execution_id}`** - 获取测试执行详情
- 路径参数：`execution_id` - 执行ID
- 响应：执行记录对象

**POST /api/v1/test-executions** - 创建测试执行记录
- 请求参数：
  ```json
  {
    "plan_id": 1,
    "case_id": 1,
    "environment_id": 1,
    "result": "passed|failed|blocked|skipped",
    "duration": 10.5,
    "notes": "string",
    "error_message": "string",
    "execution_log": "string"
  }
  ```
- 响应：创建的执行记录对象

**PUT /api/v1/test-executions/{execution_id}`** - 更新测试执行记录
- 路径参数：`execution_id` - 执行ID
- 请求参数：执行信息（部分字段）
- 响应：更新后的执行记录对象

**POST /api/v1/test-executions/{execution_id}/attachments** - 上传执行附件
- 路径参数：`execution_id` - 执行ID
- 请求：multipart/form-data，文件字段名：`file`
- 响应：附件信息对象

##### 测试报告API (`/api/v1/reports`)

**GET /api/v1/reports** - 获取测试报告列表
- 查询参数：
  - `skip`: 跳过数量
  - `limit`: 返回数量
  - `project_id`: 项目ID
  - `plan_id`: 计划ID
- 响应：报告列表数组

**GET /api/v1/reports/{report_id}`** - 获取测试报告详情
- 路径参数：`report_id` - 报告ID
- 响应：报告信息对象

**POST /api/v1/reports** - 创建测试报告
- 请求参数：
  ```json
  {
    "project_id": 1,
    "plan_id": 1,
    "report_type": "execution|plan|project|custom",
    "report_name": "string",
    "start_date": "2025-12-01",
    "end_date": "2025-12-11",
    "summary": "string",
    "report_data": {}
  }
  ```
- 响应：创建的报告对象

**PUT /api/v1/reports/{report_id}`** - 更新测试报告
- 路径参数：`report_id` - 报告ID
- 请求参数：报告信息（部分字段）
- 响应：更新后的报告对象

**DELETE /api/v1/reports/{report_id}`** - 删除测试报告
- 路径参数：`report_id` - 报告ID

##### 仪表盘API (`/api/v1/dashboard`)

**GET /api/v1/dashboard** - 获取仪表盘数据
- 查询参数：
  - `project_id`: 项目ID（可选）
  - `days`: 趋势天数（默认30）
- 响应：
  ```json
  {
    "stats": {
      "total_cases": 100,
      "total_plans": 10,
      "total_executions": 500,
      "automation_coverage": 60.5,
      "pass_rate": 85.2,
      "recent_executions": [...]
    },
    "trends": [
      {
        "date": "2025-12-11",
        "passed": 10,
        "failed": 2,
        "blocked": 1,
        "skipped": 0,
        "total": 13
      }
    ],
    "plan_progress": [...],
    "module_coverage": [...]
  }
  ```

##### 测试环境API (`/api/v1/environments`)

**GET /api/v1/environments** - 获取测试环境列表
- 查询参数：
  - `skip`: 跳过数量
  - `limit`: 返回数量
- 响应：环境列表数组

**GET /api/v1/environments/{env_id}`** - 获取测试环境详情
- 路径参数：`env_id` - 环境ID
- 响应：环境信息对象

**POST /api/v1/environments** - 创建测试环境
- 请求参数：
  ```json
  {
    "name": "string",
    "api_url": "string",
    "web_url": "string",
    "database_config": {},
    "env_variables": {},
    "description": "string"
  }
  ```
- 响应：创建的环境对象

**PUT /api/v1/environments/{env_id}`** - 更新测试环境
- 路径参数：`env_id` - 环境ID
- 请求参数：环境信息（部分字段）
- 响应：更新后的环境对象

**DELETE /api/v1/environments/{env_id}`** - 删除测试环境
- 路径参数：`env_id` - 环境ID

##### 通知API (`/api/v1/notifications`)

**GET /api/v1/notifications** - 获取通知列表
- 查询参数：
  - `skip`: 跳过数量
  - `limit`: 返回数量
  - `is_read`: 是否已读（true/false）
- 响应：通知列表数组

**GET /api/v1/notifications/{notification_id}`** - 获取通知详情
- 路径参数：`notification_id` - 通知ID
- 响应：通知信息对象

**POST /api/v1/notifications/{notification_id}/read** - 标记通知为已读
- 路径参数：`notification_id` - 通知ID
- 响应：更新后的通知对象

**DELETE /api/v1/notifications/{notification_id}`** - 删除通知
- 路径参数：`notification_id` - 通知ID

---

---

## 6. 数据模型

### 6.1 核心实体关系

```
用户（User）

项目（Project）
  ├── 模块（Module）
  │   └── 测试用例（TestCase）
  │       └── 执行记录（TestExecution）
  └── 测试计划（TestPlan）
      ├── 计划用例关联（PlanCase）
      └── 测试报告（TestReport）
```

### 6.2 主要数据实体

#### 用户（User）
- id, username, email, password_hash, full_name, department, status, created_at, updated_at

#### 项目（Project）
- id, name, description, owner_id, status, created_at, updated_at

#### 模块（Module）
- id, project_id, name, parent_id, level, sort_order, created_at, updated_at

#### 测试用例（TestCase）
- id, project_id, module_id, case_number, title, type, priority, preconditions, steps, expected_result, tags, creator_id, status, created_at, updated_at

#### 测试计划（TestPlan）
- id, project_id, plan_number, name, description, owner_id, start_date, end_date, status, created_at, updated_at

#### 测试执行（TestExecution）
- id, plan_id, case_id, executor_id, environment_id, status, result, duration, notes, attachments, executed_at, created_at

#### 测试报告（TestReport）
- id, project_id, plan_id, report_type, report_name, start_date, end_date, report_data, created_at, created_by

---

## 7. 界面设计需求

### 7.1 设计原则

- **简洁明了**：界面简洁，信息层次清晰
- **易于操作**：操作流程简单，减少用户学习成本
- **响应式设计**：适配不同屏幕尺寸
- **一致性**：保持界面风格和交互的一致性
- **可访问性**：支持键盘导航，符合无障碍设计标准

### 7.2 主要页面

1. **登录页面**：用户登录界面
2. **仪表盘页面**：测试概览和统计信息
3. **项目管理页面**：项目列表和管理
4. **测试用例管理页面**：用例列表、创建、编辑
5. **测试计划管理页面**：计划列表、创建、编辑
6. **测试执行页面**：执行用例、记录结果
7. **测试报告页面**：报告查看和导出
8. **用户管理页面**：用户管理
9. **系统设置页面**：系统配置和通知设置

### 7.3 UI组件要求

- **导航栏**：顶部导航，包含主要功能入口
- **侧边栏**：左侧菜单，快速导航
- **数据表格**：支持排序、筛选、分页
- **表单组件**：统一的表单输入组件
- **图表组件**：数据可视化图表
- **弹窗组件**：确认对话框、信息提示
- **加载状态**：加载动画和进度提示

---

## 8. 集成需求

### 8.1 第三方工具集成

- **通知工具**：邮件服务、企业微信、钉钉（可选）

### 8.2 API集成

- **提供RESTful API**：供第三方系统调用（基础功能）

---

## 9. 部署需求

### 9.1 部署方式

- **uv部署**：使用 uv 进行包管理和项目部署（推荐）
- **Docker部署**：支持Docker容器化部署
- **传统部署**：支持传统服务器部署
- **云部署**：支持云平台部署（AWS、阿里云、腾讯云等）

### 9.2 环境要求

- **Python环境**：
  - Python 3.10+
  - uv 包管理器（推荐，比 pip 快 10-100 倍）
- **服务器配置**：
  - CPU：4核以上
  - 内存：8GB以上
  - 磁盘：100GB以上（根据数据量调整）
- **数据库**：MySQL 8.0+ 或 PostgreSQL 12+
- **缓存**：Redis 6.0+
- **Web服务器**：Nginx

### 9.3 uv 部署步骤

#### 9.3.1 安装 uv

```bash
# Linux/macOS
curl -LsSf https://astral.sh/uv/install.sh | sh

# Windows (PowerShell)
powershell -ExecutionPolicy ByPass -c "irm https://astral.sh/uv/install.ps1 | iex"
```

#### 9.3.2 后端部署

```bash
# 1. 进入后端目录
cd backend

# 2. 安装依赖
uv sync

# 3. 配置环境变量
cp .env.example .env
# 编辑 .env 文件

# 4. 初始化数据库
uv run alembic upgrade head

# 5. 启动服务（开发环境）
uv run python run.py

# 或生产环境
uv run uvicorn app.main:app --host 0.0.0.0 --port 8000 --workers 4
```

#### 9.3.3 uv 的优势

- 🚀 **极快的依赖安装**：比 pip 快 10-100 倍
- 🔒 **可复现的构建**：通过锁定文件确保依赖一致性
- 📦 **项目管理**：内置虚拟环境管理，无需手动创建
- 🎯 **简单易用**：一个命令完成所有操作
- 🔄 **依赖同步**：自动管理依赖版本和冲突

### 9.4 配置要求

- **环境变量配置**：数据库连接、Redis连接、文件存储路径等
- **日志配置**：日志级别、日志路径、日志轮转
- **备份配置**：数据备份策略和计划
- **uv 配置**：通过 `pyproject.toml` 管理项目依赖和配置

---

## 10. 测试需求

### 10.1 测试范围

- **功能测试**：所有功能模块的功能测试
- **性能测试**：系统性能测试，包括压力测试、负载测试
- **安全测试**：安全性测试，包括SQL注入、XSS等
- **兼容性测试**：浏览器兼容性测试
- **用户体验测试**：界面易用性测试

### 10.2 测试环境

- **开发环境**：开发人员本地环境
- **测试环境**：独立的测试环境，用于功能测试
- **预发布环境**：接近生产环境的预发布环境
- **生产环境**：正式运行的生产环境

---

## 11. 项目里程碑

### 11.1 第一阶段：基础功能（MVP）
- 用户认证与管理
- 项目管理
- 测试用例管理
- 测试计划管理
- 基础测试执行
- 简单仪表盘

**预计时间**：8-10周

### 11.2 第二阶段：完善功能
- 测试报告管理
- 完善测试执行功能
- 完善仪表盘
- 测试环境管理
- 通知与提醒

**预计时间**：6-8周

### 11.3 第三阶段：优化与扩展
- 功能优化
- 用户体验优化
- 性能优化
- 安全加固
- 文档完善
- 测试与修复

**预计时间**：4-6周

---

## 12. 风险评估

### 12.1 技术风险

- **性能瓶颈**：大量数据查询可能导致性能问题
  - **应对措施**：数据库优化、缓存策略、分页查询
- **并发冲突**：多用户同时操作可能导致数据冲突
  - **应对措施**：事务控制、乐观锁、操作提示
- **集成复杂度**：第三方通知工具集成可能遇到兼容性问题
  - **应对措施**：充分调研、制定集成方案、预留缓冲时间

### 12.2 项目风险

- **需求变更**：需求可能频繁变更
  - **应对措施**：需求评审、变更控制流程
- **进度延期**：开发进度可能延期
  - **应对措施**：合理评估、预留缓冲时间、分阶段交付
- **人员变动**：关键人员可能变动
  - **应对措施**：文档完善、知识共享、代码审查

### 12.3 业务风险

- **用户接受度**：用户可能不适应新系统
  - **应对措施**：用户培训、友好界面、逐步迁移
- **数据迁移**：历史数据迁移可能遇到问题
  - **应对措施**：数据迁移方案、数据验证、回滚方案

---

## 13. 后续规划

### 13.1 功能扩展

- **AI辅助**：AI辅助测试用例生成、测试结果分析
- **移动端APP**：开发移动端应用
- **测试数据管理**：测试数据管理和数据脱敏
- **性能测试集成**：集成性能测试工具
- **安全测试集成**：集成安全测试工具
- **缺陷管理**：集成缺陷管理功能
- **API接口管理**：API接口测试和管理功能
- **CI/CD集成**：与持续集成工具深度集成

### 13.2 技术优化

- **微服务架构**：向微服务架构演进
- **容器化**：全面容器化部署
- **云原生**：支持云原生部署
- **大数据分析**：测试数据分析和挖掘

---

## 14. 附录

### 14.1 术语表

- **ATS**：Automated Test System，自动化测试系统
- **API**：Application Programming Interface，应用程序编程接口
- **MVP**：Minimum Viable Product，最小可行产品

### 14.2 参考资料

- 《软件测试的艺术》
- RESTful API设计规范

---

## 文档修订历史

| 版本 | 日期 | 修订人 | 修订内容 |
|------|------|--------|---------|
| v1.0 | 2025-12-11 | - | 初始版本 |
| v1.1 | 2025-12-11 | - | 删除一期不包含的功能：缺陷管理、API接口管理、CI/CD集成，调整为后续规划功能 |
| v1.2 | 2025-12-14 | - | 移除权限模块相关内容，简化用户管理功能 |

---

**文档结束**
